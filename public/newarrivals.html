<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>BookLust - New Arrivals</title>
    <!-- bootstrap css from cdn-->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />

    <link rel="stylesheet" href="./css/style.css" />
    <!-- font awesome cdn-->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
      crossorigin="anonymous"
    />
    <!--Bootstrap table css  -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.css"
    />

    <!-- Firebase SDKs -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.1.1/firebase-app.min.js"
      integrity="sha512-IUK2Oz9upp47fk1QFxuMNvqbpB+PBpO1I9V5+hNL0KqitBdIaEXhy2zSPGVGltzKKqK5f0L0P3zqafKa7kf8Qw=="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.1.1/firebase-firestore.min.js"
      integrity="sha512-D0jUM6G/75Fw7ihlen91+V6lmoR416c1Wm0Q+I2r4ylrZKsjyhjz/kizO08trRWKscRhUexEpLKdxP+1t2TvjQ=="
      crossorigin="anonymous"
    ></script>
  </head>


  <body>

    <!-- navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
      <div class="container">
        <a class="navbar-brand" href="./index.html"
          ><img src="./images/logo1.png" style="width: 120px; height: 30px"
        /></a>
        <button
          class="navbar-toggler custom-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarSupportedContent"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="./index.html">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#books"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Books
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="./trending.html">Trending</a>
                <a class="dropdown-item active" href="./newarrivals.html"
                  >New Arrivals</a
                >
                <a class="dropdown-item" href="./catalog.html">Full Catalog</a>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./contactus.html">Contact Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./addbooks.html">Admin Login</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Top Wave -->
    <div class="gradient">
      <div class="container pt-4 text-center">
        <div class="row align-items-center justify-content-center">
          <div class="col-12 mb-4">
            <h2>
              Keep In Touch, We Bring Down the Newest Books From All Over The
              World
            </h2>
          </div>
        </div>
      </div>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 200">
        <path
          fill="#fff"
          fill-opacity="1"
          d="M0,128L48,117.3C96,107,192,85,288,80C384,75,480,85,576,112C672,139,768,181,864,181.3C960,181,1056,139,1152,122.7C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"
        ></path>
      </svg>
    </div>

    <!-- New Arrival Section -->
    <div class="container-fluid">
      <div class="row my-3 align-items-center justify-content-center">
        <div class="col-12">
          <h3>New Arrivals</h3>
        </div>
      </div>
      <div class="row my-3 align-items-center justify-content-center">
        <div class="col-12 table-responsive">
          <table
            data-toggle="table"
            data-pagination="true"
            id="catalog"
            class="table table-hover table-condensed table-bordered"
          >
            <thead>
              <tr>
                <th class="th-sm" data-field="bName">Title</th>
                <th class="th-sm" data-field="bAuthor">Author</th>
                <th class="th-sm" data-field="bPrice">Price</th>
                <th class="th-sm" data-field="bISBN">ISBN</th>
                <th class="th-sm" data-field="bGenre">Genre</th>
                <th class="th-sm" data-field="bView">Read More</th>
              </tr>
            </thead>
            <tbody id="catalogBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Modal Section -->
    <!-- Book Details Modal -->
    <div
      class="modal fade"
      id="bookDetails"
      tabindex="-1"
      role="dialog"
      aria-labelledby="bookDetailsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content" style="text-align: justify">
          <div class="modal-header">
            <h5
              class="modal-title"
              style="color: rgb(31, 31, 213); font-weight: 900"
              id="bookDetailsModalLabel"
            ></h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" id="bookDetailsBody"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-warning"
              onclick="alert('You will be redirected to the cart')"
            >
              Buy Now
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End of Custom Modal -->

    <!-- Footer Section -->
    <footer class="">
      <div class="container-fluid text-center">
        <div class="row">
          <div class="col-12">
            <!-- Social buttons -->
            <div class="text-center center-block">
              <p class="txt-railway">Connect With Us</p>
              <a href="#"
                ><i
                  id="social-fb"
                  class="fa fa-facebook-square fa-3x social"
                ></i
              ></a>
              <a href="#"
                ><i id="social-tw" class="fa fa-twitter-square fa-3x social"></i
              ></a>
              <a href="#"
                ><i
                  id="social-gp"
                  class="fa fa-google-plus-square fa-3x social"
                ></i
              ></a>
              <a href="#contact"
                ><i
                  id="social-em"
                  class="fa fa-envelope-square fa-3x social"
                ></i
              ></a>
            </div>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-12">
            <p class="text-muted">
              Modern Web Application Development - SLIIT - Final Assignment -
              MWAD20010002 - SH KANDAUDAHEWA
            </p>
          </div>
        </div>
      </div>
    </footer>


    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyBxIIu7gfBqen_rrU_Njz-Rln2Qd4ikm4I",
        authDomain: "booklust-6dcb9.firebaseapp.com",
        databaseURL: "https://booklust-6dcb9.firebaseio.com",
        projectId: "booklust-6dcb9",
        storageBucket: "booklust-6dcb9.appspot.com",
        messagingSenderId: "535184426604",
        appId: "1:535184426604:web:509f1113c346c3dc493a49",
        measurementId: "G-PKFKK8NWT4",
      };
      // Initialize Firebase

      // Initialize Firebase
      if (firebase.apps.length == 0) {
        firebase.initializeApp(firebaseConfig);
      } else {
        console.log("Already Initializeed");
      }
      //

      const db = firebase.firestore();
      const tableBody = this.document.getElementById("catalogBody");
      const fbtable = db
        .collection("books")
        .where("bType", "==", "New Arrival");

      fbtable.get().then((snapshot) => {
        var content = "";

        snapshot.docs.forEach(
          (doc) => {
            var tbRow = doc.data();

            let html = `<tr>
            <td>${tbRow.bName}</td>
            <td>${tbRow.bAuthor}</td>
            <td>${tbRow.bPrice}</td>
            <td>${tbRow.bISBN}</td>
            <td>${tbRow.bGenre}</td>
            <td class="text-center"><button class="btn btn-warning btn-sm" id= ${tbRow.bISBN} onclick="loadBookDetails(this.id)">More..</button></td>
            </tr>`;
            content += html;
            tableBody.innerHTML = content;
          },
          (error) => {
            console.log(error.message);
          }
        );
      });
    </script>
    <!-- Load Books -->

    <script>
      function loadBookDetails(isbn, price) {
        var db = firebase.firestore();

        db.collection("books")
          .where("bISBN", "==", isbn)
          .get()
          .then(function (querySnapshot) {
            querySnapshot.forEach(function (doc) {
              this.document.getElementById("bookDetailsModalLabel").innerHTML =
                doc.data().bName + " By " + doc.data().bAuthor;
              $("#bookDetailsBody").append(
                "<p>" + doc.data().bDescription + "</p>"
              );
              $("#bookDetails").modal();
            });
          })
          .catch(function (error) {
            console.error("Error adding document: ", error);
          });
        this.document.getElementById("bookDetailsBody").innerHTML = "";
      }
    </script>
    <!-- End of Load Books -->
    <!--JQuery and bootstrap Scripts + Custom Script-->

    <script type="text/javascript" src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="./js/popper.min.js"></script>
    <script type="text/javascript" src="./js/bootstrap.min.js"></script>
    <script type="text/javascript" src="./js/custom.js"></script>


    <!-- Latest compiled and minified JavaScript -->
    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.js"></script>
    <!-- Latest compiled and minified Locales -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.0/locale/bootstrap-table-en-US.min.js"
      integrity="sha512-t6Sh/zpgdIfOQu4/mH8QUhK85SIU6t6pOI5eGcgHugj6k4m5S2tb96X6GKKa7b4fR9nV0tPOVpqbwPU6gaT6vQ=="
      crossorigin="anonymous"
    ></script>

    <!-- Scroll Top Button Code -->
    <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
    <script type="text/javascript" src="./js/scrollTop.js"></script>
    <!-- End of Scroll Top -->
  </body>
</html>
